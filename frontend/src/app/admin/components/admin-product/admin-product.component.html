<div class="container mt-4">
  <h2 class="mb-3 text-center">{{ isEdit ? 'Update' : 'Create' }} Product</h2>

  <form [formGroup]="form" (ngSubmit)="submitForm()" enctype="multipart/form-data" class="mb-4 border p-3 bg-light rounded shadow-sm">
    <div class="row">
      <div class="col-md-6 mb-3">
        <label class="form-label">Product Name</label>
        <input type="text" formControlName="productName" class="form-control" />
      </div>
      <div class="col-md-6 mb-3">
        <label class="form-label">Price</label>
        <input type="number" formControlName="price" class="form-control" />
      </div>
      <div class="col-md-6 mb-3">
        <label class="form-label">Quantity</label>
        <input type="number" formControlName="quantity" class="form-control" />
      </div>
      <div class="col-md-6 mb-3">
        <label class="form-label">Gender</label>
        <select formControlName="gender" class="form-control">
          <option value="">Select Gender</option>
          <option value="male">Male</option>
          <option value="female">Female</option>
        </select>
      </div>
      <div class="col-md-6 mb-3">
        <label class="form-label">Stock Alert Threshold</label>
        <input type="number" formControlName="stockAlertThreshold" class="form-control" />
      </div>
      <div class="col-md-6 mb-3">
        <label class="form-label">Brand</label>
        <select formControlName="brandId" class="form-control">
          <option value="">Select Brand</option>
          <option *ngFor="let brand of brands" [value]="brand._id">{{ brand.brandName }}</option>
        </select>
      </div>
      <div class="col-md-6 mb-3">
        <label class="form-label">SubCategory</label>
        <select formControlName="subcategoryId" class="form-control">
          <option value="">Select SubCategory</option>
          <option *ngFor="let sub of subcategories" [value]="sub._id">{{ sub.subcategoryName }}</option>
        </select>
      </div>
      <div class="col-md-6 mb-3">
        <label class="form-label">Product Image</label>
        <input type="file" (change)="handleImageChange($event)" class="form-control" />
      </div>
    </div>
    <div class="text-end">
      <button type="submit" class="btn btn-success me-2">{{ isEdit ? 'Update' : 'Create' }}</button>
      <button type="button" class="btn btn-secondary" (click)="resetForm()">Cancel</button>
    </div>
  </form>

  <div class="text-end mb-3">
    <button class="btn btn-outline-primary" (click)="toggleView()">
      Show {{ isDeletedView ? 'Active' : 'Deleted' }} Products
    </button>
  </div>

  <div class="row">
    <div class="col-md-4 mb-3" *ngFor="let product of products">
      <div class="card h-100 shadow-sm">
        <img [src]="product.productImages[0]" class="card-img-top" style="height: 200px; object-fit: contain;" />
        <div class="card-body">
  <h5 class="card-title">{{ product.productName }}</h5>
  <p class="card-text">Price: {{ product.price }} EGP</p>
  <p class="card-text">Quantity: {{ product.quantity }}</p>
  <p class="card-text">Gender: {{ product.gender }}</p>

  <button *ngIf="!isDeletedView" class="btn btn-warning btn-sm me-2" (click)="editProduct(product)">Edit</button>
  <button *ngIf="!isDeletedView" class="btn btn-danger btn-sm" (click)="deleteProduct(product._id)">Delete</button>
  <button *ngIf="isDeletedView" class="btn btn-success btn-sm" (click)="restoreProduct(product._id)">Restore</button>
</div>

      </div>
    </div>
  </div>

  <nav class="mt-3" *ngIf="totalPages > 1">
    <ul class="pagination justify-content-center">
      <li class="page-item" [class.disabled]="page === 1">
        <button class="page-link" (click)="prevPage()">Previous</button>
      </li>
      <li class="page-item disabled">
        <span class="page-link">{{ page }} / {{ totalPages }}</span>
      </li>
      <li class="page-item" [class.disabled]="page === totalPages">
        <button class="page-link" (click)="nextPage()">Next</button>
      </li>
    </ul>
  </nav>
</div>
